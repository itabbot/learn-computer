# MQTT<!-- omit in toc -->

- [1. 快速开始](#1-快速开始)
  - [1.1. 相关资源](#11-相关资源)
  - [1.2. 定义](#12-定义)
  - [1.3. 背景](#13-背景)
  - [1.4. 应用场景](#14-应用场景)
  - [1.5. 尝试](#15-尝试)
- [2. 按需学习](#2-按需学习)
- [3. 系统学习](#3-系统学习)

## 1. 快速开始

### 1.1. 相关资源

[官方网站](https://mqtt.org) | [标准规范](https://mqtt.org/mqtt-specification) | [官方推荐入门教程](https://mqtt.org/getting-started/) | [官方推荐软件](https://mqtt.org/software/)

### 1.2. 定义

MQTT，英文全称 Message Queuing Telemetry Transport，即 “消息队列遥测传输”，它是 ISO 标准（ISO/IEC PRF 20922）下的、基于发布/订阅（Publish/Subscribe）范式的、轻量级的应用层通讯协议。用于在客户端和服务器之间进行高效的可靠数据传输，它被设计用于受限的网络环境，如低带宽、高延迟或不稳定的网络连接。它具有以下特点：

- 轻量级： MQTT 的协议头部非常小，消息传输开销低，适用于资源受限的设备和网络。它的设计目标是在低带宽、高延迟或不稳定的网络环境下高效传输数据。
- 可靠性： MQTT 提供了三种服务质量等级（Quality of Service，QoS）来确保消息的可靠传递。QoS 0 表示最多一次传递，QoS 1 表示至少一次传递，QoS 2 表示仅一次传递。可以根据应用需求选择适当的 QoS 级别。
- 安全性： MQTT 支持使用 TLS/SSL 进行加密传输，保护数据的机密性和完整性。它还提供了身份验证和访问控制机制，确保只有授权的客户端可以连接和发布订阅消息。
- 支持持久化会话： MQTT 支持客户端会话状态的存储和恢复。当客户端断开连接后，服务器可以保留客户端的订阅和发布状态。当客户端重新连接时，可以恢复之前的会话，确保消息的连续性和一致性。
- 异步通信： MQTT 采用异步通信模式，客户端和服务器之间的通信不需要保持长时间的连接。客户端可以随时连接、发布消息，服务器也可以将消息推送给客户端。这种异步通信模型有助于减少网络负载和节省能源。
- 发布/订阅模式： MQTT 采用发布/订阅模式，允许多个客户端订阅消息主题（Topic），发布者将消息发布到特定主题，而订阅者只接收订阅的主题消息。这种解耦的消息传递方式使得系统更加灵活和可扩展。
- 灵活性： MQTT 具有良好的可扩展性和灵活性。它可以与其他协议和系统进行集成，支持自定义插件开发，使用户可以根据自身需求添加新的功能和逻辑。
- 可扩展性： MQTT 可以轻松地支持大量的客户端连接。由于其低资源消耗和异步通信模式，它能够处理成千上万的并发连接。

以下是 MQTT 的一些基本概念：

- 发布者（Publisher）： 发布者是一个 MQTT 客户端，负责发布消息到 MQTT 代理（broker）。发布者将消息发布到特定的主题（Topic），并将其发送给 MQTT 代理。
- 订阅者（Subscriber）： 订阅者也是一个 MQTT 客户端，负责订阅消息主题（Topic）。订阅者通过向 MQTT 代理发送订阅请求，以表明对特定主题感兴趣，并接收与该主题相关的消息。
- 主题（Topic）： 主题是 MQTT 消息的目的地。发布者将消息发布到一个特定的主题，而订阅者可以订阅一个或多个主题来接收与之关联的消息。主题可以是层次结构的，使用斜杠（/）进行层级分隔，例如"home/living-room/temperature"。
- MQTT 代理（Broker）： MQTT 代理是消息中介，负责接收发布者发布的消息，并将其传递给订阅了相应主题的订阅者。代理是 MQTT 通信的中心枢纽，它负责路由消息、处理订阅和发布操作，并维护客户端之间的连接。

### 1.3. 背景

发展历程：

- 创建： 1999 年，MQTT 协议由 IBM 的 Andy Stanford-Clark 和 Arcom（现为 Cirrus Link）的 Ian Phillips 创建，并发布了第一个版本。最初的设计目标是为了解决石油管道监测系统的通信需求，以实现最小的电池损耗和带宽使用。
- 成为国际标准： 2010 年，MQTT 成为 OASIS 标准。OASIS（Organization for the Advancement of Structured Information Standards）是一个国际标准化组织，MQTT 在其支持下成为了开放的、供公众使用的标准协议。
- 加入 Eclipse Paho 项目： 2011 年，IBM 将 MQTT 提交给 Eclipse 基金会，成为 Eclipse Paho 项目的一部分。Eclipse Paho 项目的目标是提供开源的 MQTT 客户端实现，以推动 MQTT 在物联网领域的应用。
- 版本 3.1.1 发布： 2013 年，MQTT 版本 3.1.1 发布。这个版本对协议进行了一些改进和修订，增强了安全性和可靠性。
- 被 Facebook 采用： 2014 年：Facebook 宣布在其移动应用中采用 MQTT 作为实时通信协议。这一举措使得 MQTT 在移动应用领域得到更广泛的认可和应用。
- 版本 5.0 发布： 2019 年，MQTT 版本 5.0 发布。MQTT 5.0 引入了一些新特性，如消息属性、请求/响应模式、流程控制等，进一步增强了协议的功能和灵活性。

命名历史：

- 最初，"MQ"在"MQTT"中来自 IBM 的 MQ（当时称为'MQSeries'）产品线，表示"Message Queue"（消息队列）。然而，MQTT 协议提供的是发布-订阅模式的消息传递，没有使用队列的概念。
- 在 IBM 作为版本 3.1 发布的规范中，该协议被称为"MQ Telemetry Transport"（MQ 遥测传输）。这表明在起初的设计中，MQTT 的名称中的"MQ"确实是指消息队列。
- 随后由 OASIS 发布的版本严格将协议称为"MQTT"，而不再加以解释。然而，OASIS 的技术委员会本身被命名为"OASIS Message Queuing Telemetry Transport Technical Committee"（OASIS 消息队列遥测传输技术委员会）。
- 自 2013 年开始，“MQTT”不再代表任何特定的含义，成为一个独立的协议名称。

### 1.4. 应用场景

MQTT 被设计为一种极其轻量级的发布/订阅消息传输协议，设计原则是最大限度地减少网络带宽和设备资源需求，同时尝试确保可靠性和一定程度的交付保证。这些原则使该协议成为连接设备的 “物联网（IoT）” 领域以及带宽和电池电量非常宝贵的移动应用的理想选择。例如有以下典型的应用场景：

- 物联网设备通信： MQTT 是一种轻量级、可靠的通信协议，特别适用于物联网设备之间的通信。它可以用于传输传感器数据、控制指令和设备状态信息，实现设备之间的实时通信和协作。
- 智能家居： MQTT 用于连接智能家居中的各种设备，包括智能恒温器、灯泡、安全摄像头和其他电器。这允许用户使用移动应用程序远程控制他们的家庭设备。
- 工业自动化： MQTT 在工业自动化领域广泛应用。它可以用于监测和控制设备、传输生产数据、监测环境参数等。MQTT 的轻量级特性使得它适用于带宽有限的工业网络环境，并能够满足实时性和可靠性的要求。
- 能源监测和管理： MQTT 可用于能源监测系统，例如太阳能发电系统、智能电网系统等。通过 MQTT，可以实时传输能源生产和消耗的数据，进行能源管理和优化控制。
- 农业： MQTT 用于精准农业，以监测土壤湿度、天气状况和作物生长。这有助于农民优化灌溉和其他作物管理实践。
- 医疗保健： MQTT 用于将医疗设备和传感器（例如血糖仪和心率监视器）连接到医疗保健提供者。这样可以对患者进行远程监控，从而改善患者的治疗效果并降低医疗成本。
- 车联网： MQTT 在车联网中被广泛应用。它可以用于车辆之间的通信、车辆与基础设施之间的通信，以及车辆与云平台之间的通信。通过 MQTT，车辆可以交换实时数据（如位置、传感器数据等），实现车辆远程控制、车队管理、智能交通等功能。
- 科学研究和数据采集： MQTT 可以用于科学研究和数据采集领域。例如，环境监测站点可以使用 MQTT 协议将气象数据、水质数据等实时传输到数据中心，以便进行分析和研究。

### 1.5. 尝试

## 2. 按需学习

## 3. 系统学习
