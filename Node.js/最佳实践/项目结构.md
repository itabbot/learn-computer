# 项目结构实践<!-- omit in toc -->

## 1. 按照业务或功能来规划目录结构

[参考资料](https://github.com/goldbergyoni/nodebestpractices#-11-structure-your-solution-by-components) | [实践工程](https://github.com/fooins/insbiz)

**建议**：从业务或功能的角度对文件进行分组，每个业务/功能模块都有单独的文件夹，每个文件夹就像是一个单独的组件，包含了该模块相关的控制器、模型、视图、数据库操作对象以及测试对象等等。

**而非**：而不是从技术角度对文件进行分层管理，比如控制器文件夹、模型文件夹、视图文件夹、数据操作对象文件夹以及测试对象文件夹等等。

**为什么？**

- 改动风险小：改动时不用担心会不会影响到其他的业务或功能（特别是人多业务杂的情况），也便于从业务角度梳理改动的影响面。
- 易于扩展：可以很方便地将某个业务模块独立为单独的服务或者 NPM 模块。
- 更好实施：写代码最终是为了实现功能或服务于业务，按功能或业务来组织代码，自然是顺理成章、水到渠成。

## 2. 对组件进行分层

[参考资料](https://github.com/goldbergyoni/nodebestpractices#-12-layer-your-components-keep-the-web-layer-within-its-boundaries) | [实践工程](https://github.com/fooins/insbiz)

**建议**：对每个组件（业务/功能模块）进行分层，至少应该包括 Web 层、业务逻辑层和数据访问层。数据访问层专注于对数据库进行访问，业务逻辑层专注于业务逻辑的实现，Web 层则专注于处理用户交互。

**杜绝**：不应将 Web 层对象（例如 Express 的 req 或 res）传递给业务逻辑层和数据访问层，这会让程序依赖于特定的 Web 框架并只能由其访问，无法通过测试代码、CRON 作业或消息队列的触发器等访问。

**为什么？**

- 简化结构：关注点分离，即将复杂的结构进行合理化的分解，从而使每个拆分后的部分变得简单。
- 易于测试：便于使用测试工具对每个层进行单元测试。
- 方便复用：相同的业务逻辑可以应用在多个终端，比如 PC 站点、移动 APP、后台定时任务等。
